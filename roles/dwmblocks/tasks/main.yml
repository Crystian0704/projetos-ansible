- name: Remove diretório do dwmblocks
  file:
    path: "/home/{{ usuario }}/.config/suckless/dwmblocks"
    state: absent
  become: yes
  become_user: root

- name: Clona o repositório do dwmblocks
  git:
    repo: https://github.com/torrinfail/dwmblocks
    dest: /home/{{ usuario }}/.config/suckless/dwmblocks
    clone: yes
    force: yes
  become: yes
  become_user: "{{ usuario }}"


- name: Copia o arquivo blocks.def.h, dwmblocks.c e sb-clock
  copy:
    src: "{{ item.src }}"
    dest: "/home/{{ usuario }}/.config/suckless/dwmblocks/"
    owner: "{{ usuario }}"
    group: "{{ usuario }}"
  loop:
    - {
        src: "blocks.def.h",
      }
    - {
        src: "dwmblocks.c",
      }
    - {
        src: "sb-clock",
      }
- name: Compila o dwmblocks
  shell: |
    rm -rf "/usr/local/bin/dwmblocks"
    cd /home/{{ usuario }}/.config/suckless/dwmblocks
    make
    make install


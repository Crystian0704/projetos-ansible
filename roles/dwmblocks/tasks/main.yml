- name: Remove diretório do dwmblocks
  file:
    path: "/home/{{ usuario }}/.config/suckless/dwmblocks"
    state: absent
  become: yes
  become_user: root

- name: Clona o repositório do dwmblocks
  git:
    repo: https://github.com/torrinfail/dwmblocks
    dest: /home/{{ usuario }}/.config/suckless/dwmblocks
    clone: yes
    force: yes
  become: yes
  become_user: "{{ usuario }}"


- name: Copia blocks.def.h
  copy:
    src: "{{ item.src }}"
    dest: "/home/{{ usuario }}/.config/suckless/dwmblocks/{{ item.filename }}"
    owner: "{{ usuario }}"
    group: "{{ usuario }}"
  loop:
    - {
        src: "blocks.def.h",
        filename: "blocks.def.h"
      }

- name: Compila o dwmblocks
  shell: |
    rm -rf "/usr/local/bin/dwmblocks"
    cd /home/{{ usuario }}/.config/suckless/dwmblocks
    make
    make install


